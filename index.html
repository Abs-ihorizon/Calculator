<div class="sidebar">
  <h3>ðŸ”¥ Trending Coins</h3>
  <div id="trendingCoins"></div>

  <h3>ðŸ“ˆ Trending Stocks</h3>
  <div id="trendingStocks"></div>
</div>

<script>
  const trendingCoinsDiv = document.getElementById("trendingCoins");
  const trendingStocksDiv = document.getElementById("trendingStocks");

  async function loadTrendingCoins() {
    try {
      const res = await fetch("https://api.coingecko.com/api/v3/search/trending");
      const data = await res.json();
      trendingCoinsDiv.innerHTML = "";
      const top5 = data.coins.slice(0,5);
      top5.forEach(c => {
        const div = document.createElement("div");
        div.className = "coin";
        div.innerHTML = `<img src="${c.item.thumb}"> ${c.item.name} (${c.item.symbol.toUpperCase()})`;
        div.onclick = () => selectCoin(c.item.id);
        trendingCoinsDiv.appendChild(div);
      });
    } catch (err) {
      trendingCoinsDiv.innerHTML = "Error loading trending coins";
      console.error(err);
    }
  }

  async function loadTrendingStocks() {
    try {
      const stockSymbols = ["AAPL","TSLA","MSFT","AMZN","GOOGL"]; // top 5 US stocks
      trendingStocksDiv.innerHTML = "";
      for (let s of stockSymbols) {
        const res = await fetch(`https://finnhub.io/api/v1/quote?symbol=${s}&token=${FINNHUB_API_KEY}`);
        const data = await res.json();
        const div = document.createElement("div");
        div.className = "coin";
        div.textContent = `${s}: $${data.c}`;
        div.onclick = () => selectStock(s);
        trendingStocksDiv.appendChild(div);
      }
    } catch(err) {
      trendingStocksDiv.innerHTML = "Error loading trending stocks";
      console.error(err);
    }
  }

  function selectCoin(id) {
    if(!coinSelect.querySelector(`option[value="${id}"]`)) {
      const opt = document.createElement("option");
      opt.value = id; opt.text = id;
      coinSelect.appendChild(opt);
    }
    coinSelect.value = id;
  }

  function selectStock(symbol) {
    if(!stockSelect.querySelector(`option[value="${symbol}"]`)) {
      const opt = document.createElement("option");
      opt.value = symbol; opt.text = symbol;
      stockSelect.appendChild(opt);
    }
    stockSelect.value = symbol;
  }

  // Call these on page load
  loadTrendingCoins();
  loadTrendingStocks();
</script>
